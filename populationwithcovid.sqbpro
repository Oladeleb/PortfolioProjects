<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="/Users/barbara/Desktop/data_analyst_projects/covid19.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="5221"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,20:mainpopulationvaccinated"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="CovidVaccinations" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="62"/><column index="2" value="58"/><column index="3" value="69"/><column index="4" value="55"/><column index="5" value="59"/><column index="6" value="63"/><column index="7" value="137"/><column index="8" value="134"/><column index="9" value="115"/><column index="10" value="189"/><column index="11" value="74"/><column index="12" value="84"/><column index="13" value="89"/><column index="14" value="101"/><column index="15" value="103"/><column index="16" value="130"/><column index="17" value="97"/><column index="18" value="153"/><column index="19" value="170"/><column index="20" value="173"/><column index="21" value="199"/><column index="22" value="214"/><column index="23" value="95"/><column index="24" value="106"/><column index="25" value="69"/><column index="26" value="82"/><column index="27" value="82"/><column index="28" value="86"/><column index="29" value="95"/><column index="30" value="123"/><column index="31" value="114"/><column index="32" value="91"/><column index="33" value="81"/><column index="34" value="126"/><column index="35" value="154"/><column index="36" value="88"/><column index="37" value="147"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="CovidVaccinations-1" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="14" mode="1"/></sort><column_widths><column index="1" value="62"/><column index="2" value="58"/><column index="3" value="69"/><column index="4" value="55"/><column index="5" value="59"/><column index="6" value="63"/><column index="7" value="137"/><column index="8" value="134"/><column index="9" value="115"/><column index="10" value="189"/><column index="11" value="74"/><column index="12" value="84"/><column index="13" value="89"/><column index="14" value="101"/><column index="15" value="103"/><column index="16" value="130"/><column index="17" value="97"/><column index="18" value="153"/><column index="19" value="170"/><column index="20" value="173"/><column index="21" value="199"/><column index="22" value="214"/><column index="23" value="95"/><column index="24" value="106"/><column index="25" value="69"/><column index="26" value="82"/><column index="27" value="82"/><column index="28" value="86"/><column index="29" value="95"/><column index="30" value="123"/><column index="31" value="114"/><column index="32" value="91"/><column index="33" value="81"/><column index="34" value="126"/><column index="35" value="154"/><column index="36" value="88"/><column index="37" value="147"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="covid_data" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="62"/><column index="2" value="58"/><column index="3" value="69"/><column index="4" value="55"/><column index="5" value="73"/><column index="6" value="66"/><column index="7" value="63"/><column index="8" value="118"/><column index="9" value="72"/><column index="10" value="68"/><column index="11" value="124"/><column index="12" value="127"/><column index="13" value="123"/><column index="14" value="179"/><column index="15" value="132"/><column index="16" value="129"/><column index="17" value="185"/><column index="18" value="101"/><column index="19" value="71"/><column index="20" value="132"/><column index="21" value="81"/><column index="22" value="141"/><column index="23" value="126"/><column index="24" value="186"/><column index="25" value="136"/><column index="26" value="196"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="covid_vac_data" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="62"/><column index="2" value="58"/><column index="3" value="69"/><column index="4" value="55"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="percentageofpopulationvaccinated" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="5" mode="0"/></sort><column_widths><column index="1" value="58"/><column index="2" value="50"/><column index="3" value="31"/><column index="4" value="63"/><column index="5" value="97"/><column index="6" value="132"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="populationvaccinated" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="82"/><column index="2" value="112"/><column index="3" value="55"/><column index="4" value="68"/><column index="5" value="97"/><column index="6" value="132"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">---SELECT continent, MAX (cast( total_deaths as INT) ) as total_dth
---total dth by continent
---SELECT
---FROM covid_data
---WHERE continent IS NOT NULL
--GROUP BY continent 
---ORDER BY total_dth 


--- view for data visualization 
CREATE VIEW populationvaccinated AS
SELECT dea.continent, dea.location, dea.date, dea.population, vac.new_vaccinations,
SUM(CAST(vac.new_vaccinations as INT)) OVER (Partition by dea.Location Order by dea.location, dea.Date) as rollingpeoplevaccinated
From covid_data dea
Join CovidVaccinations vac
	On dea.location = vac.location
	and dea.date = vac.date
WHERE dea.continent is not null 
AND  new_vaccinations IS NOT NULL;</sql><sql name="SQL 2">
--- SUM of all new vaccinations by locations  
----SELECT  c.date,  c.continent, c.location, c.population, c.iso_code,  vac.new_vaccinations,
----SUM(CAST(vac.new_vaccinations  as INT) )  OVER (PARTITION BY  c.location ORDER BY  vac.location , vac.date) AS rolling
----FROM covid_data c 
----JOIN CovidVaccinations vac 
----ON c.location = vac.location
----AND c.date = vac.date 
----AND vac.new_vaccinations IS NOT NULL
----AND c.continent is not NULL
----AND  c.continent = 'Africa' 
---AND c.iso_code = 'CIV'  -- new_vaccination + rollover, adds up, ignore zero or nulls
----ORDER BY  2,3

</sql><sql name="view">
 --- USE OF CTE 
With vaccinatedpopulation (continent, location, date, population,  new_vaccinations, iso_code,rollingvaccinated)
as
(
SELECT  c.date,  c.continent, c.location, c.population, c.iso_code,  vac.new_vaccinations,
SUM(CAST(vac.new_vaccinations  as INT) )  OVER (PARTITION BY  c.location ORDER BY  vac.location , vac.date) AS rollingvaccinated
FROM covid_data c 
JOIN CovidVaccinations vac 
ON c.location = vac.location
AND c.date = vac.date 
AND vac.new_vaccinations IS NOT NULL
AND c.continent is not NULL
AND  c.continent = 'Africa' 
AND c.iso_code = 'CIV'  --- 
)
SELECT * , CAST(rollingvaccinated as FLOAT)/population * 100  as  percentageofvaccianted
FROM vaccinatedpopulation 

</sql><sql name="SQL ">
--- find how many people are vaccinated in a country using CTE
With PopvsVac (Continent, Location, Date, Population, New_Vaccinations, RollingPeopleVaccinated)
as
(
Select dea.continent, dea.location, dea.date, dea.population, vac.new_vaccinations
, SUM(CAST(vac.new_vaccinations as INT)) OVER (Partition by dea.Location Order by dea.location, dea.Date) as RollingPeopleVaccinated
--, (RollingPeopleVaccinated/population)*100
From covid_data dea
Join CovidVaccinations vac
	On dea.location = vac.location
	and dea.date = vac.date
where dea.continent is not null 
--order by 2,3
)
Select *, (RollingPeopleVaccinated/Population)*100 as PercentPeopleVaccinated
From PopvsVac
</sql><sql name="Sample">
INSERT INTO  percentageofpopulationvaccinated
SELECT dea.continent, dea.location, dea.date, dea.population, vac.new_vaccinations,
SUM(CAST(vac.new_vaccinations as INT)) OVER (Partition by dea.Location Order by dea.location, dea.Date) as rollingpeoplevaccinated
From covid_data dea
Join CovidVaccinations vac
	On dea.location = vac.location
	and dea.date = vac.date
WHERE dea.continent is not null 
AND  new_vaccinations IS NOT NULL;

SELECT *, (rollingpeoplevaccinated/population) *100
FROM  percentageofpopulationvaccinated

</sql><sql name="TBL_percentageofpopulationvaccinated">
Create  TABLE percentageofpopulationvaccinated 
(
continent  TEXT(255),
location  TEXT(255),
date  datetime,
population  TEXT (255),
new_vaccinations  TEXT (255),
rollingpeoplevaccinated  TEXT (255)
 )</sql><current_tab id="0"/></tab_sql></sqlb_project>
